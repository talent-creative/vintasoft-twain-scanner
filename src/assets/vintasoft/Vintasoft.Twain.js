// Copyright 2014-2023 VintaSoft Ltd. All rights reserved.
// This software is protected by International copyright laws.
// Any copying, duplication, deployment, redistribution, modification or other
// disposition hereof is STRICTLY PROHIBITED without an express written license
// granted by VintaSoft Ltd. This notice may not be removed or otherwise
// altered under any circumstances.
// This code may NOT be used apart of the VintaSoft product.
var Vintasoft;
(function(p){if(void 0==p.Shared)throw Error("Vintasoft.Shared is not found.");if("3.4.0.1"!==p.version)throw Error("Wrong version of Vintasoft.Shared script.");p.Twain=p.Twain||(p.Twain={});(function(k){function r(a,e){if(null==a)throw Error("Parameter 'successFunc' cannot be null.");if(!b.pv.isf(a))throw Error("Parameter 'successFunc' must be a function.");if(null==e)throw Error("Parameter 'errorFunc' cannot be null.");if(!b.pv.isf(e))throw Error("Parameter 'errorFunc' must be a function.");}k.version=
"14.0.4.1";var b=p.Shared,la=b.EnumGenerator.create([{None:0},{Get:1},{GetDefault:2},{GetCurrent:4}],!0),J=b.EnumGenerator.create([{DeviceEvent:7},{ImageAcquired:2},{ImageAcquiring:1},{ImageAcquiringProgress:8},{None:0},{ScanCanceled:5},{ScanCompleted:3},{ScanFailed:4},{ScanFinished:9},{UserInterfaceClosed:6}],!1),P=b.EnumGenerator.create([{CustomHalftone:2},{Diffusion:3},{Halftones:1},{Threshold:0}],!1),ga=b.EnumGenerator.create([{Auto:0},{Clear:1},{NoClear:2}],!1),K=b.EnumGenerator.create([{None:0},
{OnePass:1},{TwoPass:2}],!1),Q=b.EnumGenerator.create([{Black:8},{Blue:2},{Cyan:5},{Green:1},{Magenta:6},{None:3},{Red:0},{White:4},{Yellow:7}],!1),R=b.EnumGenerator.create([{DetectAndExcludeJobSeparatorAndContinueScanning:3},{DetectAndExcludeJobSeparatorAndStopScanning:4},{DetectAndIncludeJobSeparatorAndContinueScanning:1},{DetectAndIncludeJobSeparatorAndStopScanning:2},{None:0}],!1),S=b.EnumGenerator.create([{Reflective:0},{Transmissive:1}],!1),T=b.EnumGenerator.create([{Blue:2},{Green:1},{InfraRed:6},
{None:3},{Red:0},{UltraViolet:5},{White:4}],!1),U=b.EnumGenerator.create([{Auto:1},{LonePixel:2},{MajorityRule:3},{None:0}],!1),V=b.EnumGenerator.create([{Auto:1},{Current:2},{None:0}],!1),W=b.EnumGenerator.create([{Auto:4},{AutoPicture:6},{AutoText:5},{Landscape:3},{Portrait:0},{Rotation180:2},{Rotation90:1}],!1),X=b.EnumGenerator.create([{A0:19},{A0x2:18},{A0x4:17},{A1:20},{A10:25},{A2:21},{A3:11},{A4:1},{A5:5},{A6:13},{A7:22},{A8:23},{A9:24},{B3:12},{B4:6},{B5:2},{B6:7},{BUSINESSCARD:53},{C0:44},
{C1:45},{C10:51},{C2:46},{C3:47},{C4:14},{C5:15},{C6:16},{C7:48},{C8:49},{C9:50},{ISOB0:26},{ISOB1:27},{ISOB10:33},{ISOB2:28},{ISOB3:12},{ISOB4:6},{ISOB5:29},{ISOB6:7},{ISOB7:30},{ISOB8:31},{ISOB9:32},{JISB0:34},{JISB1:35},{JISB10:43},{JISB2:36},{JISB3:37},{JISB4:38},{JISB6:39},{JISB7:40},{JISB8:41},{JISB9:42},{None:0},{USEXECUTIVE:10},{USLEDGER:9},{USLEGAL:4},{USLETTER:3},{USSTATEMENT:52}],!1),Y=b.EnumGenerator.create([{Chocolate:0},{Vanilla:1}],!1),C=b.EnumGenerator.create([{BGR:12},{BW:0},{CIELAB:13},
{CIELUV:14},{CIEXYZ:8},{CMY:4},{CMYK:5},{Gray:1},{Infrared:16},{Lab:9},{Palette:3},{RGB:2},{SRGB:10},{SRGB64:11},{YCBCR:15},{YUV:6},{YUVK:7}],!1),Z=b.EnumGenerator.create([{File:1},{Memory:2},{Native:0}],!1),D=b.EnumGenerator.create([{BitFields:12},{Group31D:2},{Group31DEol:3},{Group32D:4},{Group4:5},{Jbig:8},{Jpeg:6},{Lzw:7},{None:0},{Packbits:1},{Png:9},{Rle4:10},{Rle8:11}],!1),$=b.EnumGenerator.create([{Bmp:2},{Dejavu:14},{EXIF:9},{FlashPix:5},{Jpeg:4},{Jpeg2000:11},{Jpeg2000JPN:12},{Jpeg2000JPX:13},
{PDF:10},{PDFA:15},{Pict:1},{Png:7},{SamsungSrw:32770},{SPIFF:8},{Tiff:0},{TiffMulti:6},{XBM:3}],!1),aa=b.EnumGenerator.create([{Array:3},{Enum:4},{OneValue:5},{Range:6},{Undefined:0}],!1),ba=b.EnumGenerator.create([{Bool:6},{Fix32:7},{Frame:8},{Int16:1},{Int16Handle:44},{Int32:2},{Int8:0},{Str1024:13},{Str128:11},{Str255:12},{Str32:9},{Str64:10},{UInt16:4},{UInt32:5},{UInt32Handle:43},{UInt8:3},{UInt8Handle:15},{Undefined:-1},{Uni512:14}],!1),ca=b.EnumGenerator.create([{Centimeters:1},{Inches:0},
{Millimeters:6},{Picas:2},{Pixels:5},{Points:3},{Twips:4}],!1),L=b.EnumGenerator.create([{XferCount:1},{ICompression:256},{IPixelType:257},{IUnits:258},{IXferMech:259},{Author:4096},{Caption:4097},{FeederEnabled:4098},{FeederLoaded:4099},{TimeDate:4100},{SupportedCaps:4101},{ExtendedCaps:4102},{AutoFeed:4103},{ClearPage:4104},{FeedPage:4105},{RewindPage:4106},{Indicators:4107},{SupportedCapsExt:4108},{PaperDetectable:4109},{UIControllable:4110},{DeviceOnline:4111},{AutoScan:4112},{ThumbnailsEnabled:4113},
{Duplex:4114},{DuplexEnabled:4115},{EnableDsUiOnly:4116},{CustomDsData:4117},{EndOrSer:4118},{JobControl:4119},{Alarms:4120},{AlarmVolume:4121},{AutomaticCapture:4122},{TimeBeforeFirstCapture:4123},{TimeBetweenCaptures:4124},{ClearBuffers:4125},{MaxBatchBuffers:4126},{DeviceTimeDate:4127},{PowerSupply:4128},{CameraPreviewUI:4129},{DeviceEvents:4130},{SerialNumber:4132},{Printer:4134},{PrinterEnabled:4135},{PrinterIndex:4136},{PrinterMode:4137},{PrinterString:4138},{PrinterSuffix:4139},{Language:4140},
{FeederAlignment:4141},{FeederOrder:4142},{ReacquireAllowed:4144},{BatteryMinutes:4146},{BatteryPercentage:4147},{CameraSide:4148},{Segmented:4149},{AutomaticSenseMedium:4155},{CameraEnabled:4150},{CameraOrder:4151},{MicrEnabled:4152},{FeederPrep:4153},{FeederPocket:4154},{CustomInterfaceGuid:4156},{SupportedCapsSegmentUnique:4157},{SupportedDats:4158},{DoubleFeedDetection:4159},{DoubleFeedDetectionLength:4160},{DoubleFeedDetectionSensitivity:4161},{DoubleFeedDetectionResponse:4162},{PaperHandling:4163},
{IndicatorsMode:4164},{PrinterVerticalOffset:4165},{PowerSaveTime:4166},{ISupportedExtImageInfo:4446},{IAutoBright:4352},{IBrightness:4353},{IContrast:4355},{ICustomHalftone:4356},{IExposureTime:4357},{IFilter:4358},{IFlashUsed:4359},{IGamma:4360},{IHalftones:4361},{IHighlight:4362},{IImageFileFormat:4364},{ILampState:4365},{ILightSource:4366},{IOrientation:4368},{IPhysicalWidth:4369},{IPhysicalHeight:4370},{IShadow:4371},{IFrames:4372},{IXNativeResolution:4374},{IYNativeResolution:4375},{IXResolution:4376},
{IYResolution:4377},{IMaxFrames:4378},{ITiles:4379},{IBitOrder:4380},{ICcittKFactor:4381},{ILightPath:4382},{IPixelFlavor:4383},{IPlanarChunky:4384},{IRotation:4385},{ISupportedSizes:4386},{IThreshold:4387},{IXScaling:4388},{IYScaling:4389},{IBitOrderCodes:4390},{IPixelFlavorCodes:4391},{IJpegPixelType:4392},{ITimeFill:4394},{IBitDepth:4395},{IBitDepthReduction:4396},{IUndefinedImageSize:4397},{IImageDataSet:4398},{IExtImageInfo:4399},{IMinimumHeight:4400},{IMinimumWidth:4401},{IFlipRotation:4406},
{IBarCodeDetectionEnabled:4407},{ISupportedBarCodeTypes:4408},{IBarCodeMaxSearchPriorities:4409},{IBarCodeSearchPriorities:4410},{IBarCodeSearchMode:4411},{IBarCodeMaxRetries:4412},{IBarCodeTimeout:4413},{IZoomFactor:4414},{IPatchCodeDetectionEnabled:4415},{ISupportedPatchCodeTypes:4416},{IPatchCodeMaxSearchPriorities:4417},{IPatchCodeSearchPriorities:4418},{IPatchCodeSearchMode:4419},{IPatchCodeMaxRetries:4420},{IPatchCodeTimeout:4421},{IFlashUsed2:4422},{IImageFilter:4423},{INoiseFilter:4424},{IOverScan:4425},
{IAutomaticBorderDetection:4432},{IAutomaticDeskew:4433},{IAutomaticRotate:4434},{IJpegQuality:4435},{IFeederType:4436},{IIccProfile:4437},{IAutoSize:4438},{IAutoDiscardBlankPages:4404},{IAutomaticCropUsesFrame:4439},{IAutomaticLengthDetection:4440},{IAutomaticColorEnabled:4441},{IAutomaticColorNonColorPixelType:4442},{IColorManagementEnabled:4443},{IImageMerge:4444},{IImageMergeHeightThreshold:4445},{IFilmType:4447},{IMirror:4448},{IJpegSubsampling:4449},{PrinterCharRotation:4167},{PrinterFontStyle:4168},
{PrinterIndexLeadChar:4169},{PrinterIndexMaxValue:4170},{PrinterIndexNumDigits:4171},{PrinterIndexStep:4172},{PrinterIndexTrigger:4173},{PrinterStringPreview:4174}],!1),ha=b.EnumGenerator.create([{Afghanistan:1001},{Algeria:213},{Americansamoa:684},{Andorra:33},{Angola:1002},{Anguilla:8090},{Antigua:8091},{Argentina:54},{Aruba:297},{Ascensioni:247},{Australia:61},{Austria:43},{Bahamas:8092},{Bahrain:973},{Bangladesh:880},{Barbados:8093},{Belgium:32},{Belize:501},{Benin:229},{Bermuda:8094},{Bhutan:1003},
{Bolivia:591},{Botswana:267},{Britain:6},{Britvirginis:8095},{Brazil:55},{Brunei:673},{Bulgaria:359},{Burkinafaso:1004},{Burma:1005},{Burundi:1006},{Camaroon:237},{Canada:2},{Capeverdeis:238},{Caymanis:8096},{CentralAfRep:1007},{Chad:1008},{Chile:56},{China:86},{Christmasis:1009},{Cocosis:1009},{Colombia:57},{Comoros:1010},{Congo:1011},{Cookis:1012},{Costarica:506},{Cuba:5},{Cyprus:357},{Czechoslovakia:42},{Denmark:45},{Djibouti:1013},{Dominica:8097},{Domincanrep:8098},{Easteris:1014},{Ecuador:593},
{Egypt:20},{Elsalvador:503},{Eqguinea:1015},{Ethiopia:251},{Falklandis:1016},{Faeroeis:298},{FijiIslands:679},{Finland:358},{France:33},{Frantilles:596},{Frguiana:594},{Frpolyneisa:689},{Futanais:1043},{Gabon:241},{Gambia:220},{Germany:49},{Ghana:233},{Gibralter:350},{Greece:30},{Greenland:299},{Grenada:8099},{Grenedines:8015},{Guadeloupe:590},{Guam:671},{Guantanamobay:5399},{Guatemala:502},{Guinea:224},{Guineabissau:1017},{Guyana:592},{Haiti:509},{Honduras:504},{Hongkong:852},{Hungary:36},{Iceland:354},
{India:91},{Indonesia:62},{Iran:98},{Iraq:964},{Ireland:353},{Israel:972},{Italy:39},{Ivorycoast:225},{Jamaica:8010},{Japan:81},{Jordan:962},{Kenya:254},{Kiribati:1018},{Korea:82},{Kuwait:965},{Laos:1019},{Lebanon:1020},{Liberia:231},{Libya:218},{Liechtenstein:41},{Luxenbourg:352},{Macao:853},{Madagascar:1021},{Malawi:265},{Malaysia:60},{Maldives:960},{Mali:1022},{Malta:356},{Marshallis:692},{Mauritania:1023},{Mauritius:230},{Mexico:3},{Micronesia:691},{Miquelon:508},{Monaco:33},{Mongolia:1024},{Montserrat:8011},
{Morocco:212},{Mozambique:1025},{Namibia:264},{Nauru:1026},{Nepal:977},{Netherlands:31},{Nethantilles:599},{Nevis:8012},{Newcaledonia:687},{Newzealand:64},{Nicaragua:505},{Niger:227},{Nigeria:234},{Niue:1027},{Norfolki:1028},{Norway:47},{Oman:968},{Pakistan:92},{Palau:1029},{Panama:507},{Paraguay:595},{Peru:51},{Phillippines:63},{Pitcairnis:1030},{Pnewguinea:675},{Poland:48},{Portugal:351},{Qatar:974},{Reunioni:1031},{Romania:40},{Rwanda:250},{Saipan:670},{Sanmarino:39},{Saotome:1033},{SaudiArabia:966},
{Senegal:221},{Seychellesis:1034},{Sierraleone:1035},{Singapore:65},{Solomonis:1036},{Somali:1037},{SouthAfrica:27},{Spain:34},{Srilanka:94},{Sthelena:1032},{Stkitts:8013},{Stlucia:8014},{Stpierre:508},{Stvincent:8015},{Sudan:1038},{Suriname:597},{Swaziland:268},{Sweden:46},{Switzerland:41},{Syria:1039},{Taiwan:886},{Tanzania:255},{Thailand:66},{Tobago:8016},{Togo:228},{Tongais:676},{Trinidad:8016},{Tunisia:216},{Turkey:90},{Turkscaicos:8017},{Tuvalu:1040},{Uganda:256},{UaEmirates:971},{UnitedKingdom:44},
{Usa:1},{Uruguay:598},{Vanuatu:1041},{VaticanCity:39},{Venezuela:58},{Wake:1042},{Wallisis:1043},{WesternSahara:1044},{WesternSamoa:1045},{Yemen:1046},{Yugoslavia:38},{Zaire:243},{Zambia:260},{Zimbabwe:263},{Albania:355},{Armenia:374},{Azerbaijan:994},{Belarus:375},{Bosniaherzgo:387},{Cambodia:855},{Croatia:385},{CzechRepublic:420},{Diegogarcia:246},{Eritrea:291},{Estonia:372},{Georgia:995},{Latvia:371},{Lesotho:266},{Lithuania:370},{Macedonia:389},{Mayotteis:269},{Moldova:373},{Myanmar:95},{NorthKorea:850},
{Puertorico:787},{Russia:7},{Serbia:381},{Slovakia:421},{Slovenia:386},{SouthKorea:82},{Ukraine:380},{UsVirginis:340},{Vietnam:84}],!1),ia=b.EnumGenerator.create([{UserLocale:-1},{Danish:0},{Dutch:1},{English:2},{FrenchCanadian:3},{Finnish:4},{French:5},{German:6},{Icelandic:7},{Italian:8},{Norwegian:9},{Portuguese:10},{Spanish:11},{Swedish:12},{EnglishUsa:13},{Afrikaans:14},{Albania:15},{Arabic:16},{ArabicAlgeria:17},{ArabicBahrain:18},{ArabicEgypt:19},{ArabicIraq:20},{ArabicJordan:21},{ArabicKuwait:22},
{ArabicLebanon:23},{ArabicLibya:24},{ArabicMorocco:25},{ArabicOman:26},{ArabicQatar:27},{ArabicSaudiArabia:28},{ArabicSyria:29},{ArabicTunisia:30},{ArabicUae:31},{ArabicYemen:32},{Basque:33},{Byelorussian:34},{Bulgarian:35},{Catalan:36},{Chinese:37},{ChineseHongkong:38},{ChinesePrc:39},{ChineseSingapore:40},{ChineseSimplified:41},{ChineseTaiwan:42},{ChineseTraditional:43},{Croatia:44},{Czech:45},{DutchBelgian:46},{EnglishAustralian:47},{EnglishCanadian:48},{EnglishIreland:49},{EnglishNewZealand:50},
{EnglishSouthAfrica:51},{EnglishUnitedKingdom:52},{Estonian:53},{Faeroese:54},{Farsi:55},{FrenchBelgian:56},{FrenchLuxembourg:57},{FrenchSwiss:58},{GermanAustrian:59},{GermanLuxembourg:60},{GermanLiechtenstein:61},{GermanSwiss:62},{Greek:63},{Hebrew:64},{Hungarian:65},{Indonesian:66},{ItalianSwiss:67},{Japanese:68},{Korean:69},{KoreanJihab:70},{Latvian:71},{Lithuanian:72},{NorwegianBokmal:73},{NorwegianNynorsk:74},{Polish:75},{PortugueseBrazil:76},{Romanian:77},{Russian:78},{SerbianLatin:79},{Slovak:80},
{Slovenian:81},{SpanishMexican:82},{SpanishModern:83},{Thai:84},{Turkish:85},{Ukrainian:86},{Assmese:87},{Bengali:88},{Bihari:89},{Bodo:90},{Dogri:91},{Gujarati:92},{Haryanvi:93},{Hindi:94},{Kannada:95},{Kashmiri:96},{Malayalam:97},{Marathi:98},{Marwari:99},{Meghalayan:100},{Mizo:101},{Naga:102},{Orissi:103},{Punjabi:104},{Pushtu:105},{SerbianCyrillic:106},{Sikkimi:107},{SwedishFinland:108},{Tamil:109},{Telugu:110},{Tripuri:111},{Urdu:112},{Vietnamese:113}],!1),t=function(){};t._1103=null;t._1162=
null;t._370=null;t._239=null;t.register=function(b,e,g,w){t._1103=b;t._1162=e;t._370=g;t._239=w};var M=function(a,e,g,w){var l=M.prototype;l.get_Left=function(){return this._124};l.set_Left=function(a){b.pv.n(a);this._124=a};l.get_Top=function(){return this._167};l.set_Top=function(a){b.pv.n(a);this._167=a};l.get_Right=function(){return this._156};l.set_Right=function(a){b.pv.n(a);this._156=a};l.get_Bottom=function(){return this._226};l.set_Bottom=function(a){b.pv.n(a);this._226=a};l.equals=function(a){return b.pv.ic(a,
M)?this._124===a._124&&this._167===a._167&&this._156===a._156&&this._226===a._226:!1};l.toRectangle=function(){return{x:this._124,y:this._167,width:this._156-this._124,height:this._226-this._167}};l.toString=function(){return"("+this._124+";"+this._167+")-("+this._156+";"+this._226+")"};b.pv.n(a,e,g,w);this._124=a;this._167=e;this._156=g;this._226=w},N=function(a,e,g){var w=N.prototype;b.pv.n(a,e,g);this._1046=a;this._507=e;this._736=g;w.get_MinValue=function(){return this._1046};w.get_MaxValue=function(){return this._507};
w.get_StepSize=function(){return this._736}},E=function(a,e,g,w){var l=E.prototype;b.pv.n(a,e,g,w);this._465=a;this._255=e;this._578=g;this._734=w;l.get_X=function(){return this._465};l.get_Y=function(){return this._255};l.get_Width=function(){return this._578};l.get_Height=function(){return this._734}},da=function(a,e,g,w,l,m,d){var c=da.prototype;b.pv.n(a);b.pv.s(e);if(!b.pv.ic(g,aa))throw Error("Parameter 'containerType' is not an instance of WebTwainValueContainerTypeEnumJS class.");if(!b.pv.ic(w,
ba))throw Error("Parameter 'valueType' is not an instance of WebTwainValueTypeEnumJS class.");this._290=a;this._602=e;this._1105=g;this._146=w;this._367=l;this._875=m;this._984=d;c.get_Id=function(){return this._290};c.get_Name=function(){return this._602};c.get_ContainerType=function(){return this._1105};c.get_ValueType=function(){return this._146};c.get_CurrentValue=function(){return this._367};c.get_DefaultValue=function(){return this._875};c.get_SupportedValues=function(){return this._984}},O=
function(a,e){var g=O.prototype;null!=a&&0==Array.isArray(a)&&b.pv.te("Parameter 'supportedValuesAsArray' must represent array.");if(null!=e&&!b.pv.ic(e,N))throw Error("Parameter 'supportedValuesAsRange' is not an instance of WebTwainRangeJS class.");this._923=a;this._111=e;g.get_SupportedValuesAsArray=function(){return this._923};g.get_SupportedValuesAsRange=function(){return this._111}},z=function(){var a=z.prototype;a.get_IsTwain2Compatible=function(){return this._83};a.set_IsTwain2Compatible=
function(a){b.pv.b(a);this._83=a};a.get_Is32BitDevicesSupported=function(){return this._799};a.set_Is32BitDevicesSupported=function(a){b.pv.b(a);this._799=a};a.get_Is64BitDevicesSupported=function(){return this._90};a.set_Is64BitDevicesSupported=function(a){b.pv.b(a);this._90=a};a.get_CountryCode=function(){return this._376};a.set_CountryCode=function(a){this._376=b.pv.e(a,k.WebCountryCodeEnumJS)};a.get_LanguageType=function(){return this._899};a.set_LanguageType=function(a){b.pv.e(a,k.WebLanguageTypeEnumJS);
this._899=a};a.get_TopMostUiWindow=function(){return this._279};a.set_TopMostUiWindow=function(a){b.pv.b(a);this._279=a};a.get_AllowableSessionInactivityTime=function(){return this._638};a.set_AllowableSessionInactivityTime=function(a){b.pv.n(a);(100>a||36E5<a)&&pv.toe();this._638=a};this._90=this._799=this._83=!0;this._376=new ha(1);this._899=new ia(2);this._279=!0;this._638=6E4};b.WebServiceJS.defaultTwainService=-1;var H=function(a){function e(a,d,c){var e=!1,h="",f=!1;null!=d&&null!=c&&(f=!0);
var n=new b.WebRequestJS("GetDeviceInfos",function(b){var c=b.devices;b=b.defaultDeviceIndex;for(var f=[],h=0;h<c.length;h++){var n=c[h],n=new A(n.productName,n.productFamily,n.manufacturer,n.driverVersion,n.twainVersion,a,n.is64Bit);f.push(n)}if(null!=a._228)for(h=0;h<a._228.length;){c=a._228[h];for(n=0;n<f.length;n++)if(c._234===f[n]._234){f[n]=c;break}a._228.splice(h,1)}a._228=f;a._1172=f[b];e=!0;null!=d&&d(a,a._228,a._1172)},function(b){h=void 0!==b.errorMessage&&""!==b.errorMessage?b.errorMessage:
"Information about TWAIN devices is not received.";null!=c&&c(a,h)},{data:{twainSessionId:a._121}},f);a._623.sendRequest(n);if(!f&&!e)throw Error(h);}function g(a){!1===a._490&&b.pv.te("TWAIN device manager is not opened.")}function w(a){var d=new b.WebRequestJS("RefreshTwainSession",null,null,{data:{twainSessionId:a._121}});a._623.sendRequest(d)}var l=H.prototype;null==a&&(a=b.WebServiceJS.defaultTwainService);b.pv.c(a,b.WebServiceJS,"You should specify correct TWAIN service OR define the default TWAIN service.");
this._623=a;this._1172=this._157=this._228=this._621=this._121=this._17=null;this._490=!1;this._83=!0;l.get_IsOpened=function(){return this._490};l.get_IsTwain2Compatible=function(){return this._83};l.get_OpenedDevice=function(){return this._157};l.get_TwainServiceVersion=function(){return this._17};l.get_TwainApiVersion=function(){return k.version};l.get_TwainSessionId=function(){return this._121};l.get_Devices=function(){g(this);null==this._228&&e(this);return this._228};l.get_DefaultDevice=function(){g(this);
null==this._228&&e(this);return this._1172};l.open=function(a){function d(){w(h)}function c(b){h._490=!0;h._83=a._83;n=!0}function e(a){g=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"TWAIN device manager is not opened."}b.pv.c(a,z);var h=this,f=!1,n=!1,g="",l={data:{isTwain2Compatible:a._83,regUser:t._1103,regUrl:t._1162,regCode:t._370,expirationDate:t._239,is32BitDevicesSupported:a._799,is64BitDevicesSupported:a._90,applicationUrl:window.location.href,countryCode:a._376.valueOf(),
languageType:a._899.valueOf()}},l=new b.WebRequestJS("CreateTwainSession",function(b){b.serviceVersion!==k.version?g='Vintasoft Web TWAIN service version "'+b.serviceVersion+'" differs from VintaSoft TWAIN JavaScript API version "'+k.version+'". Please use the same version for Vintasoft Web TWAIN service and VintaSoft TWAIN JavaScript API.':(h._17=b.serviceVersion,h._121=b.sessionId,h._621=setInterval(d,a._638),f=!0)},function(a){g=a.serviceVersion!==k.version?'Vintasoft Web TWAIN service version "'+
a.serviceVersion+'" differs from VintaSoft TWAIN JavaScript API version "'+k.version+'". Please use the same version for Vintasoft Web TWAIN service and VintaSoft TWAIN JavaScript API.':void 0!==a.errorMessage&&""!==a.errorMessage?void 0!==a.Message?void 0!==a.MessageDetail?a.errorMessage+" "+a.Message+" "+a.MessageDetail:a.errorMessage+" "+a.Message:a.errorMessage:"Vintasoft Web TWAIN service is not found."},l,!1);this._623.sendRequest(l);if(f){if(l={data:{twainSessionId:this._121,applicationProductName:a._applicationProductName,
topMostUiWindow:a._279}},l=new b.WebRequestJS("OpenDeviceManager",c,e,l,!1),h._623.sendRequest(l),!n)throw Error(g);}else throw Error(g);};l.openAsync=function(a,d,c){function e(){w(n)}function h(b){n._490=!0;n._83=a._83;d(n)}function f(a){var b="TWAIN device manager is not opened.";void 0!==a.errorMessage&&""!==a.errorMessage&&(b=a.errorMessage);c(n,b)}b.pv.c(a,z);r(d,c);var n=this,g={data:{isTwain2Compatible:a._83,regUser:t._1103,regUrl:t._1162,regCode:t._370,expirationDate:t._239,is32BitDevicesSupported:a._799,
is64BitDevicesSupported:a._90,applicationUrl:window.location.href,countryCode:a._376.valueOf(),languageType:a._899.valueOf()}},l=new b.WebRequestJS("CreateTwainSession",function(d){d.serviceVersion!==k.version?c(n,'Vintasoft Web TWAIN service version "'+d.serviceVersion+'" differs from VintaSoft TWAIN JavaScript API version "'+k.version+'". Please use the same version for Vintasoft Web TWAIN service and VintaSoft TWAIN JavaScript API.'):(n._17=d.serviceVersion,n._121=d.sessionId,n._621=setInterval(e,
a._638),g={data:{twainSessionId:n._121,applicationProductName:a._applicationProductName,topMostUiWindow:a._279}},d=new b.WebRequestJS("OpenDeviceManager",h,f,g),n._623.sendRequest(d))},function(a){var b="Vintasoft Web TWAIN service is not found.";void 0!==a.errorMessage&&""!==a.errorMessage&&(b=void 0!==a.Message?void 0!==a.MessageDetail?a.errorMessage+" "+a.Message+" "+a.MessageDetail:a.errorMessage+" "+a.Message:a.errorMessage);c(n,b)},g);this._623.sendRequest(l)};l.close=function(){g(this);var a=
this,d=!1,c="";null!=this._621&&(clearInterval(this._621),this._621=null);var e=new b.WebRequestJS("CloseTwainSession",function(b){a._490=!1;a._17=null;a._121=null;a._228=null;a._157=null;a._1172=null;d=!0},function(a){c=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"TWAIN device manager is not closed."},{data:{twainSessionId:this._121}},!1);this._623.sendRequest(e);if(!d)throw Error(c);};l.closeAsync=function(a,d){r(a,d);g(this);var c=this;null!=this._621&&(clearInterval(this._621),
this._621=null);var e=new b.WebRequestJS("CloseTwainSession",function(b){c._490=!1;c._17=null;c._121=null;c._228=null;c._157=null;c._1172=null;a(c)},function(a){var b="",b=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"TWAIN device manager is not closed.";d(c,b)},{data:{twainSessionId:this._121}});this._623.sendRequest(e)};l.getDevicesAsync=function(a,b){r(a,b);g(this);null==this._228?e(this,a,b):a(this,this._228,this._1172)}},ea=function(a){function e(a,b){return a._807.getCapability(b,
4).get_CurrentValue()}var g=ea.prototype;b.pv.c(a,A);this._807=a;g.get_Enabled=function(){return e(this,4098)};g.set_Enabled=function(a){b.pv.b(a);this._807.setCapability(4098,a.toString())};g.get_PaperDetectable=function(){return e(this,4109)};g.get_Loaded=function(){return e(this,4099)};g.get_DuplexMode=function(){return e(this,4114)};g.get_DuplexEnabled=function(){return e(this,4115)};g.set_DuplexEnabled=function(a){b.pv.b(a);this._807.setCapability(4115,a.toString())};g.get_AutoFeed=function(){return e(this,
4103)};g.set_AutoFeed=function(a){b.pv.b(a);this._807.setCapability(4103,a.toString())};g.feedPage=function(){this._807.setCapability(4105,(!0).toString())};g.clearPage=function(){this._807.setCapability(4104,(!0).toString())};g.rewindPage=function(){this._807.setCapability(4106,(!0).toString())}},A=function(a,e,g,w,l,m,d){function c(a){if(null==a)throw Error("Parameter 'twainCapabilityId' cannot be null.");if(b.pv.ic(a,b.WebEnumItemBaseJS))a=a.valueOf();else if(!b.pv.isn(a))throw Error("Parameter 'twainCapabilityId' must be a number or an instance of WebDeviceCapabilityIdEnumJS class.");
return a}function G(a){if(null==a)throw Error("Parameter 'twainCapabilityIds' cannot be null.");if(!Array.isArray(a))throw Error("Parameter 'twainCapabilityIds' must be an array.");for(var d=[],c=0;c<a.length;c++){var f=a[c];if(b.pv.ic(f,b.WebEnumItemBaseJS))f=f.valueOf();else if(!b.pv.isn(f))throw Error("Element of array 'twainCapabilityIds' must be a number or instance of WebDeviceCapabilityIdEnumJS class.");d.push(f)}return d}function h(a){if(null==a)throw Error("Parameter 'twainCapabilitiesInfo' cannot be null.");
if(!Array.isArray(a))throw Error("Parameter 'twainCapabilitiesInfo' must be an array.");for(var d=0;d<a.length;d++){var c=a[d];if(null==c.capabilityId)throw Error("Array element in array 'twainCapabilitiesInfo' does not have field 'capabilityId'.");if(!b.pv.iss(c.capabilityId))throw Error("Field 'capabilityId' must be a string.");if(50<c.capabilityId.length)throw Error("Field 'capabilityId' cannot have more than 50 symbols.");if(null==c.capabilityValue)throw Error("Array element in array 'twainCapabilitiesInfo' does not have field 'capabilityValue'.");
}}function f(a){if(null==a)throw Error("Parameter 'twainCapabilityValue' cannot be null.");b.pv.ic(a,b.WebEnumItemBaseJS)&&(a=a.valueOf());return a}function n(a){if(null===a)a=(new p.Twain.WebTwainDeviceCapabilityUsageModeEnumJS("Get")).valueOf();else if(b.pv.ic(a,b.WebEnumItemBaseJS))a=a.valueOf();else if(!b.pv.isn(a))throw Error("Parameter 'usageMode' must be a number or an instance of WebTwainCapabilityInfoJS class.");return a}function s(a,b){return a.getCapability(b,4).get_CurrentValue()}function k(a,
b){var d=a.getCapability(b,1)._984;return null!=d?null!=d._923?d._923:d._111:null}function u(a,d,c){b.pv.ic(c,b.WebEnumItemBaseJS)&&(c=c.valueOf());return a.setCapability(d,c.toString())}function t(a){var b=a.id;null!=a.value&&z(b,a.value);null!=a.currentValue&&z(b,a.currentValue);null!=a.defaultValue&&z(b,a.defaultValue)}function z(a,d){try{d.containerType=b.pv.e(d.containerType,aa);d.valueType=b.pv.e(d.valueType,ba);var c=d.containerType.valueOf(),f=d.valueType.valueOf();if(0!==c)if(6===c)I(d,B);
else{var q=A._630[a];if(null!=q)I(d,function(a){var d=a;try{d=b.pv.e(a,q)}catch(ma){}return d});else switch(f){case 6:I(d,K);break;case 7:case 1:case 44:case 2:case 0:case 4:case 5:case 43:case 3:case 15:I(d,B);break;case 8:I(d,L)}}}catch(e){}}function I(a,b){null!=a.value&&(a.value=b(a.value));null!=a.defaultValue&&(a.defaultValue=b(a.defaultValue));a.minValue&&(a.minValue=b(a.minValue));a.maxValue&&(a.maxValue=b(a.maxValue));a.stepSize&&(a.stepSize=b(a.stepSize));var d=a.supportedValues;if(null!=
d){for(var c=[],q=0;q<d.length;q++)c[q]=b(d[q]);a.supportedValues=c}}function B(a){return+a}function K(a){return"True"===a}function L(a){var b=a.match(/\((.*);(.*)\)-\((.*);(.*)\)/);if(5==b.length){for(var d=[],c=1;c<b.length;c++)d.push(+b[c]);if(4===d.length)try{return new M(d[0],d[1],d[2],d[3])}catch(q){}}return a}function v(a){a._604._157==a&&a._490||b.pv.te("Device is not opened.")}function x(a,b){var d=null,c=a.valueOf();0!=(c&1)?d=fa(b.id,b.name,b.value):0!=(c&4)?d=fa(b.id,b.name,b.currentValue):
0!=(c&2)&&(d=fa(b.id,b.name,b.defaultValue));return d}function fa(a,b,d){var c=d.containerType.valueOf(),q=null;3==c||4==c?q=new O(d.supportedValues,null):6==c&&(q=new O(null,new N(d.minValue,d.maxValue,d.stepSize)));return new da(a,b,d.containerType,d.valueType,d.value,d.defaultValue,q)}b.pv.c(m,H);b.pv.s(a,e,g,w,l);this._604=m;this._490=!1;this._234=a;this._1113=e;this._322=g;this._132=w;this._615=l;this._544=d;this._993=this._347=this._491=null;a=A.prototype;a.get_IsOpened=function(){return this._490};
a.get_DeviceName=function(){return this._234};a.get_ProductFamily=function(){return this._1113};a.get_Manufacturer=function(){return this._322};a.get_DeviceName=function(){return this._234};a.get_DriverVersion=function(){return this._132};a.get_TwainVersion=function(){return this._615};a.get_IsTwain2Compatible=function(){return 2<=this._615};a.get_IsWIA=function(){return this._234.startsWith?this._234.startsWith("WIA - "):0===this._234.search("WIA - ")};a.get_Is64Bit=function(){return this._544};
a.get_HasFeeder=function(){v(this);return this._491};a.get_HasFlatbed=function(){v(this);return this._347};a.get_DocumentFeeder=function(){this.get_HasFeeder()||b.pv.te("Document feeder is not found.");null==this._993&&(this._993=new ea(this));return this._993};a.get_AutoBright=function(){return s(this,4352)};a.set_AutoBright=function(a){b.pv.b(a);u(this,4352,a)};a.get_AutoScan=function(){return s(this,4112)};a.set_AutoScan=function(a){b.pv.b(a);u(this,4112,a)};a.get_BitDepth=function(){return s(this,
4395)};a.set_BitDepth=function(a){b.pv.n(a);u(this,4395,a)};a.get_BitDepthReductionMode=function(){return s(this,4396)};a.set_BitDepthReductionMode=function(a){a=b.pv.e(a,P);u(this,4396,a)};a.get_Brightness=function(){return s(this,4353)};a.set_Brightness=function(a){b.pv.n(a);u(this,4353,a)};a.get_BufferedImageCount=function(){return s(this,4125)};a.set_ClearBuffers=function(a){a=b.pv.e(a,ga);u(this,4125,a)};a.get_Contrast=function(){return s(this,4355)};a.set_Contrast=function(a){b.pv.n(a);u(this,
4355,a)};a.get_FileFormat=function(){return s(this,4364)};a.set_FileFormat=function(a){a=b.pv.e(a,$);u(this,4364,a)};a.get_FileJpegQuality=function(){return s(this,4435)};a.set_FileJpegQuality=function(a){b.pv.n(a);u(this,4435,a)};a.get_Halftones=function(){return s(this,4361)};a.set_Halftones=function(a){b.pv.s(a);u(this,4361,a)};a.get_ImageCompression=function(){return s(this,256)};a.set_ImageCompression=function(a){a=b.pv.e(a,D);u(this,256,a)};a.get_ImageFilter=function(){return s(this,4358)};
a.set_ImageFilter=function(a){a=b.pv.e(a,Q);u(this,4358,a)};a.get_JobControl=function(){return s(this,4119)};a.set_JobControl=function(a){a=b.pv.e(a,R);u(this,4119,a)};a.get_LampState=function(){return s(this,4365)};a.set_LampState=function(a){b.pv.b(a);u(this,4365,a)};a.get_LightPath=function(){return s(this,4382)};a.set_LightPath=function(a){a=b.pv.e(a,S);u(this,4382,a)};a.get_LightSource=function(){return s(this,4366)};a.set_LightSource=function(a){a=b.pv.e(a,T);u(this,4366,a)};a.get_MaxBatchBuffers=
function(){return s(this,4126)};a.set_MaxBatchBuffers=function(a){b.pv.n(a);u(this,4126,a)};a.get_NoiseFilter=function(){return s(this,4424)};a.set_NoiseFilter=function(a){a=b.pv.e(a,U);u(this,4424,a)};a.get_Online=function(){return s(this,4111)};a.get_PageAutoSize=function(){return s(this,4438)};a.set_PageAutoSize=function(a){a=b.pv.e(a,V);u(this,4438,a)};a.get_PageOrientation=function(){return s(this,4368)};a.set_PageOrientation=function(a){a=b.pv.e(a,W);u(this,4368,a)};a.get_PageSize=function(){return s(this,
4386)};a.set_PageSize=function(a){a=b.pv.e(a,X);u(this,4386,a)};a.get_PixelFlavor=function(){return s(this,4383)};a.set_PixelFlavor=function(a){a=b.pv.e(a,Y);u(this,4383,a)};a.get_PixelType=function(){return s(this,257)};a.set_PixelType=function(a){a=b.pv.e(a,C);u(this,257,a)};a.get_XResolution=function(){return s(this,4376)};a.set_XResolution=function(a){b.pv.n(a);u(this,4376,a)};a.get_YResolution=function(){return s(this,4377)};a.set_YResolution=function(a){b.pv.n(a);u(this,4377,a)};a.get_Threshold=
function(){return s(this,4387)};a.set_Threshold=function(a){b.pv.n(a);u(this,4387,a)};a.get_TransferMode=function(){return s(this,259)};a.set_TransferMode=function(a){a=b.pv.e(a,Z);u(this,259,a)};a.get_UnitOfMeasure=function(){return s(this,258)};a.set_UnitOfMeasure=function(a){a=b.pv.e(a,ca);u(this,258,a)};a.get_XferCount=function(){return s(this,1)};a.set_XferCount=function(a){b.pv.n(a);u(this,1,a)};a.open=function(a,d){null!=this._604._157&&b.pv.te("Another device '"+this._604._157._234+"' is opened already.");
b.pv.b(a);null==d&&(d=!0);b.pv.b(d);var c=this,f=!1,q="",e=new b.WebRequestJS("OpenDevice",function(a){c._604._157=c;c._491=a.hasFeeder;c._347=a.hasFlatbed;f=c._490=!0},function(a){q=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"TWAIN device is not opened."},{data:{deviceName:this._234,twainSessionId:this._604._121,showUI:a,showIndicators:d}},!1);this._604._623.sendRequest(e);if(!f)throw Error(q);};a.openAsync=function(a,d,c,f){if(null==a)throw Error("Paramater 'showUI' cannot be null.");
if(null==d)throw Error("Paramater 'showIndicators' cannot be null.");b.pv.b(a);b.pv.b(d);r(c,f);null!=this._604._157&&b.pv.te("Another device '"+this._604._157._234+"' is opened already.");var q=this;a=new b.WebRequestJS("OpenDevice",function(a){q._604._157=q;q._491=a.hasFeeder;q._347=a.hasFlatbed;q._490=!0;c(q)},function(a){var b="",b=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"TWAIN device is not opened.";f(b)},{data:{deviceName:this._234,twainSessionId:this._604._121,showUI:a,
showIndicators:d}});this._604._623.sendRequest(a)};a.close=function(){v(this);var a=this,d=!1,c="",f=new b.WebRequestJS("CloseDevice",function(b){a._604._157=null;a._490=!1;d=!0},function(b){a._604._157=null;a._490=!1;c=void 0!==b.errorMessage&&""!==b.errorMessage?b.errorMessage:"TWAIN device is not closed."},{data:{twainSessionId:this._604._121}},!1);this._604._623.sendRequest(f);if(!d)throw Error(c);};a.closeAsync=function(a,d){r(a,d);v(this);var c=this,f=new b.WebRequestJS("CloseDevice",function(b){c._604._157=
null;c._490=!1;a(c)},function(a){c._604._157=null;c._490=!1;var b="",b=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"TWAIN device is not closed.";d(c,b)},{data:{twainSessionId:this._604._121}});this._604._623.sendRequest(f)};a.acquireModalSync=function(a){null==a&&(a=!1);v(this);var d=this,c=!1,f,q="";a=new b.WebRequestJS("AcquireModal",function(a){var q=a.acquireModalState,e=b.pv.e(q,J);f=2===q?new F(e,a.imageAcquiringProgressValue,new y(d._604,a.imageId)):new F(e,a.imageAcquiringProgressValue,
null,a.errorMessage);c=!0},function(a){q=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Modal image acquisition is failed."},{data:{twainSessionId:this._604._121,deviceName:this._234,isProgressResponseEnabled:a}},!1);this._604._623.sendRequest(a);if(!c)throw Error(q);return f};a.acquireModalAsync=function(a,d,c){r(a,d);null==c?c=!0:b.pv.b(c);v(this);var f=this;c=new b.WebRequestJS("AcquireModal",function(c){var e=c.acquireModalState,n=b.pv.e(e,J);if(2===e){var h=f._604,e=h._623,g=h.get_TwainSessionId(),
G=c.imageId;y._1035(e,g,G,function(b){var d=new y(h,G,b);acquireModalResult=new F(n,b.imageAcquiringProgressValue,d);a(f,acquireModalResult)},function(a){d(f,a)})}else acquireModalResult=new F(n,c.imageAcquiringProgressValue,null,c.errorMessage),a(f,acquireModalResult)},function(a){void 0!==a.errorMessage&&""!==a.errorMessage?d(f,a.errorMessage):d(f,"Modal image acquisition is failed.")},{data:{twainSessionId:this._604._121,deviceName:this._234,isProgressResponseEnabled:c}});this._604._623.sendRequest(c)};
a.cancelTransfer=function(){v(this);var a=!1,d="",c=new b.WebRequestJS("CancelTransfer",function(b){a=!0},function(a){d=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Transfer is not canceled."},{data:{twainSessionId:this._604._121,deviceName:this._234}},!1);this._604._623.sendRequest(c);if(!a)throw Error(d);};a.getSupportedCapabilities=function(a){var d=n(a);v(this);var c=!1,f,e="",d=new b.WebRequestJS("GetSupportedDeviceCapabilities",function(b){f=[];for(var d=0;d<b.capabilities.length;d++){t(b.capabilities[d]);
var e=x(a,b.capabilities[d]);null!=e&&f.push(e)}c=!0},function(a){e=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Supported capabilities are not received."},{data:{twainSessionId:this._604._121,usageMode:d,deviceName:this._234}},!1);this._604._623.sendRequest(d);if(!c)throw Error(e);return f};a.getSupportedCapabilitiesAsync=function(a,d,c){var f=n(a);r(d,c);v(this);var e=this,f=new b.WebRequestJS("GetSupportedDeviceCapabilities",function(b){for(var c=[],f=0;f<b.capabilities.length;f++){t(b.capabilities[f]);
var n=x(a,b.capabilities[f]);null!=n&&c.push(n)}d(e,c)},function(a){c(e,void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Supported capabilities are not received.")},{data:{twainSessionId:this._604._121,usageMode:f,deviceName:this._234}});this._604._623.sendRequest(f)};a.getCapability=function(a,d){var f=c(a),e=n(d);v(this);var q=!1,h,g="",f=new b.WebRequestJS("GetDeviceCapability",function(a){t(a.capability);h=x(d,a.capability);q=!0},function(a){g=void 0!==a.errorMessage&&""!==a.errorMessage?
a.errorMessage:"Capability value is not get."},{data:{twainSessionId:this._604._121,capabilityId:f,usageMode:e,deviceName:this._234}},!1);this._604._623.sendRequest(f);if(!q)throw Error(g);return h};a.getCapabilityAsync=function(a,d,f,e){a=c(a);var q=n(d);r(f,e);v(this);var h=this;a=new b.WebRequestJS("GetDeviceCapability",function(a){t(a.capability);a=x(d,a.capability);f(h,a)},function(a){e(h,void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Capability value is not get.")},{data:{twainSessionId:this._604._121,
capabilityId:a,usageMode:q,deviceName:this._234}});this._604._623.sendRequest(a)};a.getCapabilities=function(a,d){var c=G(a),f=n(d);v(this);var e=!1,h,g="",c=new b.WebRequestJS("GetDeviceCapabilities",function(a){h=[];for(var b=0;b<a.capabilities.length;b++){t(a.capabilities[b]);var c=x(d,a.capabilities[b]);null!=c&&h.push(c)}e=!0},function(a){g=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Capabilities are not received."},{data:{twainSessionId:this._604._121,capabilitiesId:c,usageMode:f,
deviceName:this._234}},!1);this._604._623.sendRequest(c);if(!e)throw Error(g);return h};a.getCapabilitiesAsync=function(a,d,c,f){a=G(a);var e=n(d);r(c,f);v(this);var h=this;a=new b.WebRequestJS("GetDeviceCapabilities",function(a){for(var b=[],f=0;f<a.capabilities.length;f++){t(a.capabilities[f]);var e=x(d,a.capabilities[f]);null!=e&&b.push(e)}c(h,b)},function(a){var b="",b=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Capabilities are not received.";f(h,b)},{data:{twainSessionId:this._604._121,
capabilitiesId:a,usageMode:e,deviceName:this._234}});this._604._623.sendRequest(a)};a.setCapability=function(a,d){var e=c(a);d=f(d);v(this);var h=!1,n,g="",e=new b.WebRequestJS("SetDeviceCapability",function(a){t(a.capability);n=x(new p.Twain.WebTwainDeviceCapabilityUsageModeEnumJS("GetCurrent"),a.capability);h=!0},function(a){g=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Capability value is not set."},{data:{twainSessionId:this._604._121,deviceName:this._234,capabilityId:e,capabilityValue:d.toString()}},
!1);this._604._623.sendRequest(e);if(!h)throw Error(g);return n};a.setCapabilityAsync=function(a,d,e,h){a=c(a);d=f(d);r(e,h);v(this);var n=this;d=new b.WebRequestJS("SetDeviceCapability",function(a){t(a.capability);a=x(new p.Twain.WebTwainDeviceCapabilityUsageModeEnumJS("GetCurrent"),a.capability);e(n,a)},function(a){var b="",b=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Capability value is not set.";h(n,b)},{data:{twainSessionId:this._604._121,deviceName:this._234,capabilityId:a,
capabilityValue:d.toString()}});this._604._623.sendRequest(d)};a.setCapabilities=function(a){h(a);v(this);var d=!1,c,f="";a=new b.WebRequestJS("SetDeviceCapabilities",function(a){c=a.setCapResults;for(a=0;a<c.length;a++){var b=c[a];if(b.success){var f=b.capability;t(f);b.capability=x(new p.Twain.WebTwainDeviceCapabilityUsageModeEnumJS("GetCurrent"),f)}}d=!0},function(a){f=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Capability value is not set."},{data:{twainSessionId:this._604._121,
deviceName:this._234,capabilityInfos:a}},!1);this._604._623.sendRequest(a);if(!d)throw Error(f);return c};a.setCapabilitiesAsync=function(a,d,c){h(a);r(d,c);v(this);var f=this;a=new b.WebRequestJS("SetDeviceCapabilities",function(a){a=a.setCapResults;for(var b=0;b<a.length;b++){var c=a[b];if(c.success){var e=c.capability;t(e);c.capability=x(new p.Twain.WebTwainDeviceCapabilityUsageModeEnumJS("GetCurrent"),e)}}d(f,a)},function(a){var b="",b=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:
"Capability value is not set.";c(f,b)},{data:{twainSessionId:this._604._121,deviceName:this._234,capabilityInfos:a}});this._604._623.sendRequest(a)};a.getSupportedBitDepths=function(){return k(this,4395)};a.getSupportedBrightnesValues=function(){return k(this,4353)};a.getSupportedContrastValues=function(){return k(this,4355)};a.getSupportedFileFormats=function(){return k(this,4364)};a.getSupportedImageCompressions=function(){return k(this,256)};a.getSupportedImageFilters=function(){return k(this,
4358)};a.getSupportedPageOrientations=function(){return k(this,4368)};a.getSupportedPageSizes=function(){return k(this,4386)};a.getSupportedPixelFlavors=function(){return k(this,4383)};a.getSupportedPixelTypes=function(){return k(this,257)};a.getSupportedXResolutions=function(){return k(this,4376)};a.getSupportedYResolutions=function(){return k(this,4377)};a.getSupportedTransferModes=function(){return k(this,259)};a.getSupportedUnitOfMeasures=function(){return k(this,258)};a.getDefaultImageLayout=
function(){v(this);var a=!1,d,c="",f=new b.WebRequestJS("GetDefaultDeviceImageLayout",function(b){d=new E(b.frameX,b.frameY,b.frameWidth,b.frameHeight);a=!0},function(a){c=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Default image layout is not get."},{data:{twainSessionId:this._604._121,deviceName:this._234,documentNumber:1,frameNumber:1,pageNumber:1}},!1);this._604._623.sendRequest(f);if(!a)throw Error(c);return d};a.getDefaultImageLayoutAsync=function(a,d){r(a,d);v(this);var c=
this,f=new b.WebRequestJS("GetDefaultDeviceImageLayout",function(b){b=new E(b.frameX,b.frameY,b.frameWidth,b.frameHeight);a(c,b)},function(a){d(c,void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Default image layout is not get.")},{data:{twainSessionId:this._604._121,deviceName:this._234,documentNumber:1,frameNumber:1,pageNumber:1}});this._604._623.sendRequest(f)};a.getImageLayout=function(){v(this);var a=!1,d,c="",f=new b.WebRequestJS("GetDeviceImageLayout",function(b){d=new E(b.frameX,
b.frameY,b.frameWidth,b.frameHeight);a=!0},function(a){c=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Current image layout is not get."},{data:{twainSessionId:this._604._121,deviceName:this._234,documentNumber:1,frameNumber:1,pageNumber:1}},!1);this._604._623.sendRequest(f);if(!a)throw Error(c);return d};a.getImageLayoutAsync=function(a,d){r(a,d);v(this);var c=this,f=new b.WebRequestJS("GetDeviceImageLayout",function(b){b=new E(b.frameX,b.frameY,b.frameWidth,b.frameHeight);a(c,b)},
function(a){d(c,void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Current image layout is not get.")},{data:{twainSessionId:this._604._121,deviceName:this._234,documentNumber:1,frameNumber:1,pageNumber:1}});this._604._623.sendRequest(f)};a.resetImageLayout=function(){v(this);var a=!1,d="",c=new b.WebRequestJS("ResetDeviceImageLayout",function(b){a=!0},function(a){d=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Image layout is not reset."},{data:{twainSessionId:this._604._121,
deviceName:this._234,documentNumber:1,frameNumber:1,pageNumber:1}},!1);this._604._623.sendRequest(c);if(!a)throw Error(d);};a.resetImageLayoutAsync=function(a,d){r(a,d);v(this);var c=this,f=new b.WebRequestJS("ResetDeviceImageLayout",function(b){a(c)},function(a){d(c,void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Image layout is not reset.")},{data:{twainSessionId:this._604._121,deviceName:this._234,documentNumber:1,frameNumber:1,pageNumber:1}});this._604._623.sendRequest(f)};a.setImageLayout=
function(a,d,c,f){b.pv.n(a,d,c,f);v(this);var e=!1,h="";a=new b.WebRequestJS("SetDeviceImageLayout",function(a){e=!0},function(a){h=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Image layout is not set."},{data:{twainSessionId:this._604._121,deviceName:this._234,documentNumber:1,frameNumber:1,pageNumber:1,frameX:a,frameY:d,frameWidth:c,frameHeight:f}},!1);this._604._623.sendRequest(a);if(!e)throw Error(h);};a.setImageLayoutAsync=function(a,d,c,f,e,h){b.pv.n(a,d,c,f);r(e,h);v(this);
var n=this;a=new b.WebRequestJS("SetDeviceImageLayout",function(a){e(n)},function(a){h(n,void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Image layout is not set.")},{data:{twainSessionId:this._604._121,deviceName:this._234,documentNumber:1,frameNumber:1,pageNumber:1,frameX:a,frameY:d,frameWidth:c,frameHeight:f}});this._604._623.sendRequest(a)}};A._630=[];(function(){var a=A._630;a[4396]=P;a[4364]=$;a[256]=D;a[4358]=Q;a[4119]=R;a[4382]=S;a[4366]=T;a[4424]=U;a[4438]=V;a[4368]=W;a[4386]=
X;a[4383]=Y;a[257]=C;a[259]=Z;a[258]=ca;a[4101]=L;a[4114]=K})();var F=function(a,e,g,k){var l=F.prototype;if(void 0==a)throw Error("Parameter 'acquireModalState' cannot be undefined.");if(null==a)throw Error("Parameter 'acquireModalState' cannot be null.");b.pv.c(a,J,"Parameter 'acquireModalState' is not an instance of WebAcquireModalStateEnumJS class.");null!=e&&b.pv.n(e);null!=g&&b.pv.c(g,y,"Parameter 'acquiredImage' is not an instance of WebAcquiredImageJS class.");null!=k&&b.pv.s(k);this._606=
a;this._1064=e;this._287=g;this._910=k;l.get_AcquireModalState=function(){return this._606};l.get_ImageAcquiringProgressValue=function(){return this._1064};l.get_AcquiredImage=function(){return this._287};l.get_ErrorMessage=function(){return this._910}},y=function(a,e,g){function k(a){var b=!1,e="",h={type:"POST",data:{twainSessionId:a._1142.get_TwainSessionId(),imageId:a._290}},h=new p.Shared.WebRequestJS("GetImageInfo",function(f){l(a,f);b=!0},function(a){e=void 0!==a.errorMessage&&""!==a.errorMessage?
a.errorMessage:"Image info is not received."},h,!1);a._1142._623.sendRequest(h);if(!b)throw Error(e);}function l(a,b){a._578=b.imageWidth;a._734=b.imageHeight;a._966=new C(b.imagePixelType);a._433=b.imageBitCount;a._1123=b.imageSamplesPerPixel;a._407=b.imageXResolution;a._1060=b.imageYResolution;a._718=new D(b.imageCompression)}var m=y.prototype;b.pv.c(a,H,"Parameter 'twainDeviceManager' is not an instance of class WebTwainDeviceManagerJS.");b.pv.s(e);this._1142=a;this._290=e;this._578;this._734;
this._966;this._433;this._1123;this._407;this._1060;this._718;this._343=!1;null==g?k(this):l(this,g);m.get_Id=function(){return this._290};m.get_Width=function(){return this._578};m.get_Height=function(){return this._734};m.get_PixelType=function(){return this._966};m.get_BitCount=function(){return this._433};m.get_SamplesPerPixel=function(){return this._1123};m.get_XResolution=function(){return this._407};m.get_YResolution=function(){return this._1060};m.get_Compression=function(){return this._718};
m.getAsBase64String=function(){var a=this,b=!1,e,h="",f={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId(),imageId:this._290,imageEncoderName:"PNG"}},f=new p.Shared.WebRequestJS("GetImage",function(f){a._578=f.imageWidth;a._734=f.imageHeight;a._966=new C(f.imagePixelType);a._433=f.imageBitCount;a._1123=f.imageSamplesPerPixel;a._407=f.imageXResolution;a._1060=f.imageYResolution;a._718=new D(f.imageCompression);e="data:image/png;base64,"+f.imageAsBase64String;b=!0},function(a){h=void 0!==
a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Image bitmap is not retrieved."},f,!1);this._1142._623.sendRequest(f);if(!b)throw Error(h);return e};m.getAsBase64StringAsync=function(a,b){r(a,b);var e=this,h={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId(),imageId:this._290,imageEncoderName:"PNG"}},h=new p.Shared.WebRequestJS("GetImage",function(b){e._578=b.imageWidth;e._734=b.imageHeight;e._966=new C(b.imagePixelType);e._433=b.imageBitCount;e._1123=b.imageSamplesPerPixel;e._407=
b.imageXResolution;e._1060=b.imageYResolution;e._718=new D(b.imageCompression);a(e,"data:image/png;base64,"+b.imageAsBase64String)},function(a){var d="",d=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Image bitmap is not retrieved.";b(d)},h);this._1142._623.sendRequest(h)};m.isBlank=function(a){b.pv.n(a);this._343&&b.pv.te("Image is in processing now.");this._343=!0;var c=this,e=!1,h={},f="";a={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId(),imageId:this._290,maxNoiseLevel:a}};
a=new p.Shared.WebRequestJS("IsImageBlank",function(a){h=new B(a.isBlank,a.noiseLevel);c._343=!1;e=!0},function(a){c._343=!1;f=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Image processing is failed."},a,!1);this._1142._623.sendRequest(a);if(!e)throw Error(f);return h};m.isBlankAsync=function(a,c,e){b.pv.n(a);r(c,e);this._343&&b.pv.te("Image is in processing now.");this._343=!0;var h=this;a={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId(),imageId:this._290,maxNoiseLevel:a}};
a=new p.Shared.WebRequestJS("IsImageBlank",function(a){a=new B(a.isBlank,a.noiseLevel);h._343=!1;c(h,a)},function(a){h._343=!1;var b="",b=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Image processing is failed.";e(b)},a);this._1142._623.sendRequest(a)};m.invert=function(){this._343&&b.pv.te("Image is in processing now.");this._343=!0;var a=this,c=!1,e="",h={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId(),imageId:this._290}},h=new p.Shared.WebRequestJS("InvertImage",
function(b){a._343=!1;c=!0},function(b){a._343=!1;e=void 0!==b.errorMessage&&""!==b.errorMessage?b.errorMessage:"Image processing is failed."},h,!1);this._1142._623.sendRequest(h);if(!c)throw Error(e);};m.invertAsync=function(a,c){r(a,c);this._343&&b.pv.te("Image is in processing now.");this._343=!0;var e=this,h={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId(),imageId:this._290}},h=new p.Shared.WebRequestJS("InvertImage",function(b){e._343=!1;a(e)},function(a){e._343=!1;var b="",
b=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Image processing is failed.";c(b)},h);this._1142._623.sendRequest(h)};m.changeBrightness=function(a){b.pv.n(a);this._343&&b.pv.te("Image is in processing now.");this._343=!0;var c=this,e=!1,h="";a={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId(),imageId:this._290,brightness:a}};a=new p.Shared.WebRequestJS("ChangeImageBrightness",function(a){c._343=!1;e=!0},function(a){c._343=!1;h=void 0!==a.errorMessage&&""!==a.errorMessage?
a.errorMessage:"Image processing is failed."},a,!1);this._1142._623.sendRequest(a);if(!e)throw Error(h);};m.changeBrightnessAsync=function(a,c,e){b.pv.n(a);r(c,e);this._343&&b.pv.te("Image is in processing now.");this._343=!0;var h=this;a={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId(),imageId:this._290,brightness:a}};a=new p.Shared.WebRequestJS("ChangeImageBrightness",function(a){h._343=!1;c(h)},function(a){h._343=!1;var b="",b=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:
"Image processing is failed.";e(b)},a);this._1142._623.sendRequest(a)};m.changeContrast=function(a){b.pv.n(a);this._343&&b.pv.te("Image is in processing now.");this._343=!0;var c=this,e=!1,h="";a={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId(),imageId:this._290,contrast:a}};a=new p.Shared.WebRequestJS("ChangeImageContrast",function(a){c._343=!1;e=!0},function(a){c._343=!1;h=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Image processing is failed."},a,!1);this._1142._623.sendRequest(a);
if(!e)throw Error(h);};m.changeContrastAsync=function(a,c,e){b.pv.n(a);r(c,e);this._343&&b.pv.te("Image is in processing now.");this._343=!0;var h=this;a={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId(),imageId:this._290,contrast:a}};a=new p.Shared.WebRequestJS("ChangeImageContrast",function(a){h._343=!1;c(h)},function(a){h._343=!1;var b="",b=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Image processing is failed.";e(b)},a);this._1142._623.sendRequest(a)};m.crop=function(a,
c,e,h){b.pv.n(a);b.pv.n(c);b.pv.n(e);b.pv.n(h);0>a&&b.pv.te("Parameter 'x' cannot be less than 0.");0>c&&b.pv.te("Parameter 'x' cannot be less than 0.");1>e&&b.pv.te("Parameter 'width' cannot be less than 1.");1>h&&b.pv.te("Parameter 'height' cannot be less than 1.");this._343&&b.pv.te("Image is in processing now.");this._343=!0;var f=this,g=!1,l="";a={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId(),imageId:this._290,x:a,y:c,width:e,height:h}};a=new p.Shared.WebRequestJS("CropImage",
function(a){f._343=!1;g=!0},function(a){f._343=!1;l=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Image processing is failed."},a,!1);this._1142._623.sendRequest(a);if(!g)throw Error(l);};m.cropAsync=function(a,c,e,h,f,g){b.pv.n(a);b.pv.n(c);b.pv.n(e);b.pv.n(h);0>a&&b.pv.te("Parameter 'x' cannot be less than 0.");0>c&&b.pv.te("Parameter 'x' cannot be less than 0.");1>e&&b.pv.te("Parameter 'width' cannot be less than 1.");1>h&&b.pv.te("Parameter 'height' cannot be less than 1.");r(f,
g);this._343&&b.pv.te("Image is in processing now.");this._343=!0;var l=this;a={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId(),imageId:this._290,x:a,y:c,width:e,height:h}};a=new p.Shared.WebRequestJS("CropImage",function(a){l._343=!1;f(l)},function(a){l._343=!1;var b="",b=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Image processing is failed.";g(b)},a);this._1142._623.sendRequest(a)};m.resizeCanvas=function(a,c,e,h,f){b.pv.n(a,c,e,h,f);this._343&&b.pv.te("Image is in processing now.");
this._343=!0;var g=this,l=!1,k="";a={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId(),imageId:this._290,canvasWidth:a,canvasHeight:c,canvasColor:e,imageXPosition:h,imageYPosition:f}};a=new p.Shared.WebRequestJS("ResizeCanvas",function(a){g._343=!1;l=!0},function(a){g._343=!1;k=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Image processing is failed."},a,!1);this._1142._623.sendRequest(a);if(!l)throw Error(k);};m.resizeCanvasAsync=function(a,c,e,h,f,g,l){b.pv.n(a,c,e,
h,f);r(g,l);this._343&&b.pv.te("Image is in processing now.");this._343=!0;var k=this;a={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId(),imageId:this._290,canvasWidth:a,canvasHeight:c,canvasColor:e,imageXPosition:h,imageYPosition:f}};a=new p.Shared.WebRequestJS("ResizeCanvas",function(a){k._343=!1;g(k)},function(a){k._343=!1;var b="",b=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Image processing is failed.";l(b)},a);this._1142._623.sendRequest(a)};m.rotate=function(a,
c){b.pv.n(a);void 0===c&&(c=0);b.pv.n(c);this._343&&b.pv.te("Image is in processing now.");this._343=!0;var e=this,h=!1,f="",g={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId(),imageId:this._290,angle:a,borderColor:c}},g=new p.Shared.WebRequestJS("RotateImage",function(a){e._343=!1;h=!0},function(a){e._343=!1;f=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Image processing is failed."},g,!1);this._1142._623.sendRequest(g);if(!h)throw Error(f);};m.rotateAsync=function(a,
c,e,h){b.pv.n(a);b.pv.n(c);r(e,h);this._343&&b.pv.te("Image is in processing now.");this._343=!0;var f=this;a={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId(),imageId:this._290,angle:a,borderColor:c}};a=new p.Shared.WebRequestJS("RotateImage",function(a){f._343=!1;e(f)},function(a){f._343=!1;var b="",b=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Image processing is failed.";h(b)},a);this._1142._623.sendRequest(a)};m.despeckle=function(a,c,e,h){b.pv.n(a,c,e,h);this._343&&
b.pv.te("Image is in processing now.");this._343=!0;var f=this,g=!1,l="";a={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId(),imageId:this._290,level1:a,level2:c,radius:e,level3:h}};a=new p.Shared.WebRequestJS("DespeckleImage",function(a){f._343=!1;g=!0},function(a){f._343=!1;l=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Image processing is failed."},a,!1);this._1142._623.sendRequest(a);if(!g)throw Error(l);};m.despeckleAsync=function(a,c,e,h,f,g){b.pv.n(a,c,e,h);r(f,
g);this._343&&b.pv.te("Image is in processing now.");this._343=!0;var l=this;a={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId(),imageId:this._290,level1:a,level2:c,radius:e,level3:h}};a=new p.Shared.WebRequestJS("DespeckleImage",function(a){l._343=!1;f(l)},function(a){l._343=!1;var b="",b=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Image processing is failed.";g(b)},a);this._1142._623.sendRequest(a)};m.deskew=function(a,c,e){b.pv.n(a);this._343&&b.pv.te("Image is in processing now.");
this._343=!0;var h=this,f=!1,g="";a={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId(),imageId:this._290,borderColor:a,scanIntervalX:c,scanIntervalX:e}};a=new p.Shared.WebRequestJS("DeskewImage",function(a){h._343=!1;f=!0},function(a){h._343=!1;g=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Image processing is failed."},a,!1);this._1142._623.sendRequest(a);if(!f)throw Error(g);};m.deskewAsync=function(a,c,e,h,f){b.pv.n(a);r(h,f);this._343&&b.pv.te("Image is in processing now.");
this._343=!0;var g=this;a={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId(),imageId:this._290,borderColor:a,scanIntervalX:c,scanIntervalX:e}};a=new p.Shared.WebRequestJS("DeskewImage",function(a){g._343=!1;h(g)},function(a){g._343=!1;var b="",b=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Image processing is failed.";f(b)},a);this._1142._623.sendRequest(a)};m.detectBorder=function(a){b.pv.n(a);this._343&&b.pv.te("Image is in processing now.");this._343=!0;var c=this,
e=!1,g="";a={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId(),imageId:this._290,borderSize:a}};a=new p.Shared.WebRequestJS("DetectBorder",function(a){c._343=!1;e=!0},function(a){c._343=!1;g=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Image processing is failed."},a,!1);this._1142._623.sendRequest(a);if(!e)throw Error(g);};m.detectBorderAsync=function(a,c,e){b.pv.n(a);r(c,e);this._343&&b.pv.te("Image is in processing now.");this._343=!0;var g=this;a={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId(),
imageId:this._290,borderSize:a}};a=new p.Shared.WebRequestJS("DetectBorder",function(a){g._343=!1;c(g)},function(a){g._343=!1;var b="",b=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Image processing is failed.";e(b)},a);this._1142._623.sendRequest(a)}};y._1035=function(a,b,g,k,l){b=new p.Shared.WebRequestJS("GetImageInfo",function(a){k(a)},function(a){var b="",b=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Image info is not received.";l(b)},{type:"POST",data:{twainSessionId:b,
imageId:g}});a.sendRequest(b)};var B=function(a,e){var g=B.prototype;b.pv.b(a);b.pv.n(e);this._810=a;this._405=e;g.get_IsBlank=function(){return this._810};g.get_NoiseLevel=function(){return this._405}},ja=function(a){b.pv.c(a,H,"Parameter 'twainDeviceManager' is not an instance of WebTwainDeviceManagerJS class.");this._1142=a;this._39=[];this._877=!1;this._751=new p.Twain.WebTwainTiffEncoderSettingsJS;a=ja.prototype;a.get_Count=function(){return this._39.length};a.get_TiffEncoderSettings=function(){return this._751};
a.getItem=function(a){return this._39[a]};a.add=function(a){b.pv.c(a,y,"Parameter 'image' is not an instance of class WebAcquiredImageJS.");this._39.push(a)};a.removeAt=function(a){b.pv.n(a);0>a&&b.pv.te("Parameter 'index' cannot be less than 0.");a>=this._39.length&&b.pv.te("Parameter 'index' cannot be greater than collection size.");var g=this._39[a],k=this,l=!1,m="",d={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId(),imageId:g.get_Id()}},d=new p.Shared.WebRequestJS("DeleteImage",
function(b){k._39.splice(a,1);l=!0},function(a){m=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Image is not removed from image collection."},d,!1);this._1142._623.sendRequest(d);if(!l)throw Error(m);return g};a.removeAtAsync=function(a,g,k){b.pv.n(a);0>a&&b.pv.te("Parameter 'index' cannot be less than 0.");a>=this._39.length&&b.pv.te("Parameter 'index' cannot be greater than collection size.");r(g,k);var l=this._39[a],m=this,d={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId(),
imageId:l.get_Id()}},d=new p.Shared.WebRequestJS("DeleteImage",function(b){m._39.splice(a,1);g(m,l)},function(a){var b="",b=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Image is not removed from image collection.";k(m,b)},d);this._1142._623.sendRequest(d)};a.remove=function(a){b.pv.c(a,y,"Parameter 'image' is not an instance of class WebAcquiredImageJS.");for(var g=0;g<this._39.length;g++)if(this._39[g].get_Id()==a.get_Id())return this.removeAt(g);b.pv.te("Image is not found in collection.")};
a.removeAsync=function(a,g,k){b.pv.c(a,y,"Parameter 'image' is not an instance of class WebAcquiredImageJS.");r(g,k);for(var l=0;l<this._39.length;l++)if(this._39[l].get_Id()==a.get_Id()){this.removeAt(l,g,k);return}b.pv.te("Image is not found in collection.")};a.clear=function(){function a(b){k._39.length=0;l=!0}function b(a){m=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Image collection is not cleared."}if(0==this._39.length)null!=successFunc&&successFunc(null,context);else{var k=
this,l=!1,m="",d={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId()}},d=new p.Shared.WebRequestJS("DeleteAllImages",a,b,d,!1);this._1142._623.sendRequest(d);if(!l)throw Error(m);}};a.clearAsync=function(a,b){function k(b){m._39.length=0;a(m)}function l(a){var e="",e=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Image collection is not cleared.";b(m,e)}r(a,b);if(0==this._39.length)a(this);else{var m=this,d={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId()}},
d=new p.Shared.WebRequestJS("DeleteAllImages",k,l,d);this._1142._623.sendRequest(d)}};a.saveImages=function(a,g,k){b.pv.s(a);b.pv.b(g);null==k&&b.pv.te("Parameter 'imageIds' must represent not empty array of strings.");0==Array.isArray(k)&&b.pv.te("Parameter 'imageIds' must represent not empty array of strings.");0==k.length&&b.pv.te("Parameter 'imageIds' must represent not empty array of strings.");var l=!1,m="";a={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId(),filePath:a,createNewFile:g,
imageIds:k}};null!=this._751&&(a.data.tiffEncoderSettings={jpegQuality:this._751.get_JpegQuality(),rowsPerStrip:this._751.get_RowsPerStrip(),useTiles:this._751.get_UseTiles(),tileSize:this._751.get_TileSize()});a=new p.Shared.WebRequestJS("SaveImages",function(a){l=!0},function(a){m=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Images are not saved."},a,!1);this._1142._623.sendRequest(a);if(!l)throw Error(m);};a.saveImagesAsync=function(a,g,k,l,m){b.pv.s(a);b.pv.b(g);null==k&&b.pv.te("Parameter 'imageIds' must represent not empty array of strings.");
0==Array.isArray(k)&&b.pv.te("Parameter 'imageIds' must represent not empty array of strings.");0==k.length&&b.pv.te("Parameter 'imageIds' must represent not empty array of strings.");r(l,m);var d=this,c={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId(),filePath:a,createNewFile:g,imageIds:k}};null!=this._751&&(c.data.tiffEncoderSettings={jpegQuality:this._751.get_JpegQuality(),rowsPerStrip:this._751.get_RowsPerStrip(),useTiles:this._751.get_UseTiles(),tileSize:this._751.get_TileSize()});
c=new p.Shared.WebRequestJS("SaveImages",function(b){l(d,a,g,k)},function(a){var b="",b=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Images are not saved.";m(d,b)},c);this._1142._623.sendRequest(c)};a.getAsBase64String=function(a,g){if(null==a)throw Error("Parameter 'fileName' cannot be null.");b.pv.s(a);null==g&&b.pv.te("Parameter 'imageIds' must represent not empty array of strings.");0==Array.isArray(g)&&b.pv.te("Parameter 'imageIds' must represent not empty array of strings.");
0==g.length&&b.pv.te("Parameter 'imageIds' must represent not empty array of strings.");var k=!1,l="",m="",d={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId(),fileName:a,imageIds:g}},d=new p.Shared.WebRequestJS("GetImageFile",function(a){k=!0;l=a.imageFileAsBase64String},function(a){m=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Images are not retrieved."},d,!1);this._1142._623.sendRequest(d);if(!k)throw Error(m);return l};a.getAsBase64StringAsync=function(a,g,k,l){if(null==
a)throw Error("Parameter 'fileName' cannot be null.");b.pv.s(a);null==g&&b.pv.te("Parameter 'imageIds' must represent not empty array of strings.");0==Array.isArray(g)&&b.pv.te("Parameter 'imageIds' must represent not empty array of strings.");0==g.length&&b.pv.te("Parameter 'imageIds' must represent not empty array of strings.");r(k,l);var m=this,d={type:"POST",data:{twainSessionId:this._1142.get_TwainSessionId(),fileName:a,imageIds:g}},d=new p.Shared.WebRequestJS("GetImageFile",function(b){k(m,
a,g,b.imageFileAsBase64String)},function(a){var b="",b=void 0!==a.errorMessage&&""!==a.errorMessage?a.errorMessage:"Images are not retrieved.";l(m,b)},d);this._1142._623.sendRequest(d)}},ka=function(){var a=ka.prototype;this._149=90;this._158=0;this._385=!0;this._590=256;a.get_JpegQuality=function(){return this._149};a.set_JpegQuality=function(a){this._149=10>=a?10:100<=a?100:a};a.get_RowsPerStrip=function(){return this._158};a.set_RowsPerStrip=function(a){this._158=a};a.get_UseTiles=function(){return this._385};
a.set_UseTiles=function(a){this._385=a};a.get_TileSize=function(){return this._590};a.set_TileSize=function(a){this._590=a}};k.WebTwainDeviceCapabilityUsageModeEnumJS=la;k.WebAcquireModalStateEnumJS=J;k.WebBitDepthReductionModeEnumJS=P;k.WebClearBufferModeEnumJS=ga;k.WebDuplexModeEnumJS=K;k.WebImageFilterEnumJS=Q;k.WebJobControlEnumJS=R;k.WebLightPathEnumJS=S;k.WebLightSourceEnumJS=T;k.WebNoiseFilterEnumJS=U;k.WebPageAutoSizeEnumJS=V;k.WebPageOrientationEnumJS=W;k.WebPageSizeEnumJS=X;k.WebPixelFlavorEnumJS=
Y;k.WebPixelTypeEnumJS=C;k.WebTransferModeEnumJS=Z;k.WebTwainImageCompressionEnumJS=D;k.WebTwainImageFileFormatEnumJS=$;k.WebTwainValueContainerTypeEnumJS=aa;k.WebTwainValueTypeEnumJS=ba;k.WebUnitOfMeasureEnumJS=ca;k.WebDeviceCapabilityIdEnumJS=L;k.WebCountryCodeEnumJS=ha;k.WebLanguageTypeEnumJS=ia;k.WebTwainGlobalSettingsJS=t;k.WebTwainFrameJS=M;k.WebTwainRangeJS=N;k.WebTwainImageLayoutJS=E;k.WebTwainCapabilityInfoJS=da;k.WebTwainCapabilitySupportedValuesJS=O;k.WebTwainDeviceManagerInitSettingsJS=
z;k.WebTwainDeviceManagerJS=H;k.WebTwainDeviceDocumentFeederJS=ea;k.WebTwainDeviceJS=A;k.WebTwainDeviceAcquireModalResultJS=F;k.WebAcquiredImageJS=y;k.WebAcquiredImageIsBlankResultJS=B;k.WebAcquiredImageCollectionJS=ja;k.WebTwainTiffEncoderSettingsJS=ka})(p.Twain||(p.Twain={}))})(Vintasoft||(Vintasoft={}));
